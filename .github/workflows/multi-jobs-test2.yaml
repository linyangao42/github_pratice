name: multi-jobs-test-20220418
on: 
  push:
    branches:
      - multiple-jobs-test-20220415
  workflow_dispatch:
    inputs:
      where_to_deploy:
        description: name of environment
        required: true
        default: 'qa'

jobs:
  pre-check:
    name: pre-check input
    runs-on: ubuntu-latest
    outputs:
      where_to_deploy: ${{ steps.pass-paramater.outputs.test }}
    steps:
      - run: |
          echo ${{ github.event.inputs.where_to_deploy }}
          #echo 'start'
      - name: prepare
        id: check
        uses: actions/github-script@v3
        with:
          script: |
            let where_to_deploy = 'qa';
            console.log("---1----");
            console.log(context.payload.inputs);
            if(context.payload.inputs){
              where_to_deploy = context.payload.inputs.where_to_deploy;
            }
            
            core.setOutput('where_to_deploy', where_to_deploy);
      - id: pass-paramater
        run: echo "::set-output name=test::${{steps.check.outputs.where_to_deploy}}"
        
  check:
    name: check input
    runs-on: ubuntu-latest
    needs: pre-check
    steps:
      - run: echo ${{needs.pre-check.outputs.where_to_deploy}}
